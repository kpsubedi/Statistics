Microsoft Security Advisory TechNet Products IT Resources Downloads Training Support Windows Windows Server System Center Internet Explorer Office Office Exchange Server SQL Server SharePoint Products Lync See all products Curah curation service Evaluation Center Learning Resources Microsoft Tech Companion App Microsoft Technical Communities Microsoft Virtual Academy Script Center Server and Tools Blogs TechNet Blogs TechNet Flash Newsletter TechNet Gallery TechNet Library TechNet Magazine TechNet Subscriptions TechNet Video TechNet Wiki Windows Sysinternals Virtual Labs Networking Cloud and Datacenter Security Virtualization Service Packs Security Bulletins Microsoft Update Windows Server R System Center R Microsoft SQL Server SP Windows Enterprise See all trials Microsoft Download Center TechNet Evaluation Center Drivers Windows Sysinternals TechNet Gallery Training Catalog Class Locator Microsoft Virtual Academy Free Windows Server courses Free Windows courses SQL Server training e Learning overview Certification overview MCSA Windows Windows Server Certification MCSE Private Cloud Certification MCSE SQL Server Certification MCSE TechNet Events Second shot for certification Born To Learn blog Find technical communities in your area For small and midsize businesses For enterprises For developers For IT professionals From partners For technical support Support offerings For home users Microsoft Premier Online Microsoft Fix It Center TechNet Forums MSDN Forums Security Bulletins amp Advisories International support solutions Log a support ticket Microsoft Customer Support Microsoft Community Forums Security TechCenter United States English Sign in Home Security Updates Tools Learn Library Support Export Print Expand All Security Advisories and Bulletins Security Advisories Security Bulletin Summaries Security Bulletins Vulnerability Research Advisories Acknowledgments Glossary out of rated this helpful Rate this topic Microsoft Security Advisory Local Administrator Password Solution LAPS Now Available Published May Version On this page Executive Summary Advisory FAQ Other Information Executive Summary Microsoft is offering the Local Administrator Password Solution LAPS that provides a solution to the issue of using a common local account with an identical password on every computer in a domain LAPS resolves this issue by setting a different random password for the common local administrator account on every computer in the domain Domain administrators using the solution can determine which users such as helpdesk administrators are authorized to read passwords Compromised identical local account credentials could allow elevation of privilege if an attacker uses them to elevate from a local user administrator to a domain enterprise administrator Local administrator credentials are needed for occasions when logon is required without domain access In large environments password management can become complex leading to poor security practices and such environments greatly increase the risk of a Pass the Hash PtH credential replay attack LAPS simplifies password management while helping customers implement recommended defenses against cyberattacks In particular the solution mitigates the risk of lateral escalation that results when customers use the same administrative local account and password combination on their computers Recommendation Install LAPS to automatically manage local administrator account passwords on domain joined computers so that passwords are unique on each managed computer randomly generated and centrally stored in Active Directory infrastructure LAPS stores the password for each computer s local administrator account in Active Directory in a confidential attribute in the computer s corresponding Active Directory object The computer is allowed to update its own password data in Active Directory and domain administrators can grant read access to authorized users or groups such as workstation helpdesk administrators The solution is built on Active Directory infrastructure and does not require other supporting technologies LAPS uses a Group Policy client side extension CSE that you install on managed computers to perform all management tasks The solution s management tools provide easy configuration and administration For more information see Microsoft Knowledge Base Article Microsoft Download Center Advisory FAQ What is the scope of the advisory For computers joined to an Active Directory domain Each organization s domain administrators determine which users such as helpdesk administrators are authorized to read and reset the passwords Why use LAPS instead of other password managers Other password managers typically require either additional hardware trusting a third party product or using other unsecure practices such as managing Excel spreadsheets of passwords Can LAPS manage a local administrator account not named administrator Yes What are the advantages of using LAPS to store and manage passwords LAPS provides a streamlined approach to Periodically randomize local administrator passwords to ensure that password updates to Active Directory succeed before modifying local secrets and passwords Centrally store secrets in the existing Active Directory infrastructure Control access through Active Directory access control list ACL permissions Transmit encrypted passwords from computers to Active Directory via encryption using the Kerberos version protocol and the Advanced Encryption Standard AES cypher by default LAPS customer support is available through Microsoft Premier Support Services How does LAPS work The core of the LAPS solution is a GPO client side extension CSE that performs the following tasks and can enforce the following actions during a GPO update Checks whether the password of the local Administrator account has expired Generates a new password when the old password is either expired or is required to be changed prior to expiration Validates the new password against the password policy Reports the password to Active Directory storing it with a confidential attribute with the computer account in Active Directory Reports the next expiration time for the password to Active Directory storing it with an attribute with the computer account in Active Directory Changes the password of the Administrator account The password then can be read from Active Directory by users who are allowed to do so Eligible users can request a password change for a computer What are the features of LAPS LAPS includes the following features Security that provides the ability to Randomly generate passwords that are automatically changed on managed machines Effectively mitigate PtH attacks that rely on identical local account passwords Enforced password protection during transport via encryption using the Kerberos version protocol Use access control lists ACLs to protect passwords in Active Directory and easily implement a detailed security model Manageability that provides the ability to Configure password parameters including age complexity and length Force password reset on a per machine basis Use a security model that is integrated with ACLs in Active Directory Use any Active Directory management tool of choice custom tools such as Windows PowerShell are provided Protect against computer account deletion Easily implement the solution with a minimal footprint What are the solution requirements LAPS includes the following requirements Active Directory Windows Server Service Pack SP or later Managed machines Windows Server SP or later or Windows Server x Edition SP or later Note Itanium based machines are not supported Management tools NET Framework Windows PowerShell or later Other Information Microsoft Active Protections Program MAPP To improve security protections for customers Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices such as antivirus network based intrusion detection systems or host based intrusion prevention systems To determine whether active protections are available from security software providers please visit the active protections websites provided by program partners listed in Microsoft Active Protections Program MAPP Partners Feedback You can provide feedback by completing the Microsoft Help and Support form Customer Service Contact Us Support Customers in the United States and Canada can receive technical support from Security Support For more information see Microsoft Help and Support International customers can receive support from their local Microsoft subsidiaries For more information see International Support Microsoft TechNet Security provides additional information about security in Microsoft products Disclaimer The information provided in this advisory is provided as is without warranty of any kind Microsoft disclaims all warranties either express or implied including the warranties of merchantability and fitness for a particular purpose In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct indirect incidental consequential loss of business profits or special damages even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply Revisions V May Advisory published Page generated Z Was this page helpful Yes No Not accurate Not enough depth Need more code examples Tell us more characters remaining Submit Thank you for your feedback Show Inherited Protected Microsoft Manage Your Profile Newsletter Contact Us Privacy Statement Terms of Use Trademarks Microsoft scripts length delete mtps injectScripts return script scriptsindex elem document createElement script elem className mtps injected elem async var isLoaded timeoutId injectNextFnName injectNext elem onerror function isLoaded isLoaded injectscripts index window clearTimeouttimeoutId elem onload elem onerror elem onreadystatechange null injectNextFnName delete mtpsinjectNextFnName elem removeEventListener elem removeEventListener load injectNext elem addEventListener elem addEventListener load injectNext elem readyState uninitialized elem onreadystatechange function this readyState loaded this readyState complete injectNext elem onload injectNext script hasOwnProperty url timeoutId window setTimeoutinjectNext e elem src script url injectNextFnName injectNextScript index mtpsinjectNextFnName injectNext timeoutId window setTimeoutinjectNext e elem text try n script txt n finally MTPS injectNextFnName MTPS injectNextFnName parent appendChildelem var mtps window MTPS window MTPS parent document getElementsByTagName head mtps injectScripts functionscripts injectpreloadscripts window document MTPS injectScripts txt r nwindow MTPS window MTPS cdnDomains window MTPS cdnDomains r n t image https i technet sec s msft com r n t js https i technet sec s msft com r n t css https i technet sec s msft com r n t xap https technet microsoft com r n r n url https ajax aspnetcdn com ajax jQuery jquery min js txt n var literalNormalizedUrl u en us library security mtl en us v security aspx u n var wt nvr ru uWT NVR RU u n var wt fpcdom u microsoft com u n var wt domlist utechnet microsoft com u n var wt pathlist u technet u n var wt paramlist uDCSext mtps techcenter u n var wt siteid uTECHNET u n var gDomain um webtrends com u n var gDcsId udcsjwbvbcfdrjc pt u n var gFpc uWT FPC u n n n n if document cookie indexOfgFpc n var wtidJs document createElement script n wtidJs src gDomain gDcsId wtid js n document getElementsByTagName head appendChildwtidJs n n n n n var detectedLocale uen us u n var wtsp u technet u n var gTrackEvents u u n txt n var omni guid cdac ff b afcf n txt n n window appInsightsId uaccd bc bd ecfa u n url https i technet sec s msft com Combined js resources Utilities Topic webtrendsscript omni rsid TechNet WEDCS AppInsightsPerf Toc Areas Epx Content Scripts Areas Global Content Webtrends resources Areas Global Content Omniture resources TechNet Areas Library Themes Base Content Areas Library Content uamp hashKey DACFCCBFCD uamp v EDAEECEFE txt var omnitureTracking true url https i technet sec s msft com Combined js resources megablade SearchBox Areas Epx Themes Shared Content Areas Epx Themes Base Content uamp hashKey AFBFEEEBDDBCB uamp v EDAEECEFE url https i services social microsoft com search Widgets SearchBox jss boxid HeaderSearchTextBox ubtnid HeaderSearchButton ubrand TechNet uloc en us uRefinement uwatermark TechNet ufocusOnInit false url https i technet sec s msft com Combined js resources PrintExportButton NavigationResize FeedbackCounter Areas Library Themes Base Content Areas Library Content Areas Epx Shared Content uamp hashKey BCBBFCFECDFBDC uamp v EDAEECEFE txt MTPS window MTPS MTPS LocalizedStrings window MTPS LocalizedStrings MTPS LocalizedStrings ExpandButtonTooltip uExpand u MTPS LocalizedStrings CollapseButtonTooltip uCollapse u MTPS LocalizedStrings EnhancedExpandTooltip uClick to expand Double click to expand all u MTPS LocalizedStrings EnhancedCollapseTooltip uClick to collapse Double click to collapse all u MTPS LocalizedStrings ExpandAllButtonTooltip uExpand All u MTPS LocalizedStrings CollapseAllButtonTooltip uCollapse All u url https i technet sec s msft com Combined js resources Feedback LibraryMemberFilter CodeSnippet TopicNotInScope CollapsibleArea VersionSelector SurveyBroker Areas Epx Shared Content Areas Library Content Areas Epx Content Scripts uamp hashKey EBADADEBBDCACD uamp v EDAEECEFE txt document readyfunction n try n var token globalRequestVerification inputname u RequestVerificationToken u clone n siteFeedbackForm appendtoken n catcherr n n n