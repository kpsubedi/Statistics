Quietly Mapping the Network Attack Surface context http schema org type WebSite url https hackertarget com name Online Vulnerability Scanners and Port Scans window wpemojiSettings baseUrl https s w org images core emoji x ext png source concatemoji https hackertarget com wp includes js wp emoji release min js ver functiona b c function da var c b createElement canvas d c getContext c getContext d return d d fillText d textBaseline top d font px Arial flag a d fillTextString fromCharCode c toDataURL length e d fillTextString fromCharCode d getImageData data function ea var c b createElement script c src a c type text javascript b getElementsByTagName head appendChildc var f g c supports simple d simple flag d flag c DOMReady c readyCallback function c DOMReady c supports simple c supports flag g function c readyCallback b addEventListener b addEventListener DOMContentLoaded g a addEventListener load g a attachEvent onload g b attachEvent onreadystatechange function complete b readyState c readyCallback f c source f concatemoji ef concatemoji f wpemoji f twemoji ef twemoji ef wpemoji window document window wpemojiSettings img wp smiley img emoji display inline important border none important box shadow none important height em important width em important margin em important vertical align em important background none important padding important col full wrapper max width px important ssba ssba img width px important padding px border box shadow none important display inline important vertical align middle ssba ssba a text decoration none background none font size px font weight bold logo site title logo site description display none body background color fff background repeat no repeat background position top left background attachment scroll border top px solid header background color fff background repeat no repeat background position left top margin top px margin bottom px padding top px padding bottom px border px solid logo site title a font bold px em Helvetica Neue Helvetica sans serif color logo site description font px em Helvetica Neue Helvetica sans serif color header container background color fff nav container border top px solid dbdbdb border bottom px solid dbdbdb border left none border right none nav container navigation ul main nav li first child border left px solid dbdbdb footer widgets container background color footer widgets border none footer container background color footer container border top px solid dbdbdb footer border width important body p font px em Helvetica Neue Helvetica sans serif color h font bold px em Trebuchet MS Tahoma sans serif color BCA h font bold px em Trebuchet MS Tahoma sans serif color h font px em Lucida Grande Lucida Sans Unicode Lucida Sans sans serif color h font px em Helvetica Neue Helvetica sans serif color h font bold px em Helvetica Neue Helvetica sans serif color h font bold px em Helvetica Neue Helvetica sans serif color page title post title page title font bold em em Helvetica Neue Helvetica sans serif color px solid BCA post title a link post title a visited page title a link page title a visited color px solid BCA post meta font em em Helvetica Neue Helvetica sans serif color EEE entry entry p font px em Helvetica Neue Helvetica sans serif color post more font px em Helvetica Neue Helvetica sans serif color border top px solid eee border bottom px solid eee post author connect border top px solid eee border bottom px solid eee border left px solid eee border right px solid eee border radius px moz border radius px webkit border radius px background color fafafa nav entries a woo pagination font px em Helvetica Neue Helvetica sans serif color woo pagination a woo pagination a hover color important widget h font bold px em Helvetica Neue Helvetica sans serif color border bottom px solid eee widget recent comments li twitter li border color eee widget p widget textwidget font px em Helvetica Neue Helvetica sans serif color ffffff widget font px em Helvetica Neue Helvetica sans serif color ffffff border radius px moz border radius px webkit border radius px tabs inside li a widget woodojo tabs tabbable tab pane li a font bold px em Helvetica Neue Helvetica sans serif color tabs inside li span meta widget woodojo tabs tabbable tab pane li span meta font px em Helvetica Neue Helvetica sans serif color tabs ul wooTabs li a widget woodojo tabs tabbable nav tabs li a font px em Helvetica Neue Helvetica sans serif color media only screen and min width px ul nav li a navigation ul rss a navigation cart contents navigation ul rss font px em Helvetica Neue Helvetica sans serif color aaaa navigation ul rss li a before color aaaa navigation ul nav li ul border px solid dbdbdb navigation ul nav li border right px solid dbdbdb navigation ul li first child navigation ul li first child a border radius px px moz border radius px px webkit border radius px px navigation border top px solid dbdbdb border bottom px solid dbdbdb border left px solid dbdbdb border right px solid dbdbdb border radius px moz border radius px webkit border radius px top ul nav li a font px em Helvetica Neue Helvetica sans serif color ddd footer footer p font px em Helvetica Neue Helvetica sans serif color ffffff footer background color border top px solid dbdbdb border bottom px solid border left px solid border right px solid border radius px moz border radius px webkit border radius px magazine loopedSlider content h title a font bold px em Arial sans serif color ffffff magazine loopedSlider content excerpt p font px em Arial sans serif color cccccc magazine block post title magazine block post title a font bold px em Helvetica Neue Helvetica sans serif color business loopedSlider content h font bold px em Arial sans serif color ffffff business loopedSlider content h title a font bold px em Arial sans serif color ffffff wrapper business loopedSlider content p font px em Arial sans serif color cccccc archive header font bold px em Arial sans serif color archive header border bottom px solid eee Style Generator Styles megaMenu border px solid bca border bottom background color bca background webkit gradientlinear left top left bottom from bca to bca background webkit linear gradienttop bca bca background moz linear gradienttop bca bca background ms linear gradienttop bca bca background o linear gradienttop bca bca webkit border radius px moz border radius px border radius px moz background clip padding webkit background clip padding box background clip padding box webkit box shadow inset px px px px rgba moz box shadow inset px px px px rgba box shadow inset px px px px rgba megaMenu ul megaMenu li menu item a megaMenu ul megaMenu li menu item span um anchoremulator font size px color ffffff padding px px font weight bold megaMenu megaMenuHorizontal ul megaMenu li menu item first child a border top left radius px border bottom left radius px megaMenu megaMenuHorizontal ul megaMenu li menu item a megaMenu megaMenuHorizontal ul megaMenu li menu item span um anchoremulator border left px solid bca webkit box shadow inset px px px px rgba moz box shadow inset px px px px rgba box shadow inset px px px px rgba megaMenu megaMenuVertical ul megaMenu li menu item a megaMenu megaMenuVertical ul megaMenu li menu item span um anchoremulator border top px solid bca webkit box shadow inset px px px px rgba moz box shadow inset px px px px rgba box shadow inset px px px px rgba megaMenu ul li menu item ss nav menu reg li menu item megaReg with sub a megaMenu ul li menu item ss nav menu reg li menu item megaReg with sub span um anchoremulator megaMenu ul li menu item mega with sub a megaMenu ul li menu item mega with sub span um anchoremulator megaMenu ul li menu item ss nav menu mega a megaMenu ul li menu item ss nav menu mega span um anchoremulator padding right px megaMenu ul megaMenu li menu item a span wpmega link title megaMenu ul megaMenu li menu item span um anchoremulator span wpmega link title text transform uppercase text shadow px px transparent megaMenu ul megaMenu li menu item hover a megaMenu ul megaMenu li menu item a hover megaMenu ul megaMenu li menu item megaHover a megaMenu ul megaMenu li menu item hover span um anchoremulator megaMenu ul megaMenu li menu item span um anchoremulator hover megaMenu ul megaMenu li menu item megaHover span um anchoremulator color ffffff important border bottom color transparent important background color bca background webkit gradientlinear left top left bottom from bca to bca background webkit linear gradienttop bca bca background moz linear gradienttop bca bca background ms linear gradienttop bca bca background o linear gradienttop bca bca webkit box shadow inset px px px px rgba moz box shadow inset px px px px rgba box shadow inset px px px px rgba megaMenu ul megaMenu li menu item hover a span wpmega link title megaMenu ul megaMenu li menu item hover span um anchoremulator span wpmega link title megaMenu ul megaMenu li menu item a hover span wpmega link title megaMenu ul megaMenu li menu item span um anchoremulator hover span wpmega link title megaMenu ul megaMenu li menu item megaHover a span wpmega link title megaMenu ul megaMenu li menu item megaHover span um anchoremulator span wpmega link title text shadow px px transparent megaMenu ul megaMenu li menu item current menu item a megaMenu ul megaMenu li menu item current menu parent a megaMenu ul megaMenu li menu item current menu ancestor a color ffffff megaMenu ul megaMenu li menu item ss nav menu mega ul sub menu megaMenu ul megaMenu li menu item ss nav menu reg ul sub menu border color ffffff color ffffff text shadow px px px transparent webkit box shadow px px px transparent moz box shadow px px px transparent box shadow px px px transparent background color bca background webkit gradientlinear left top left bottom from bca to bca background webkit linear gradienttop bca bca background moz linear gradienttop bca bca background ms linear gradienttop bca bca background o linear gradienttop bca bca megaMenu ul megaMenu ul sub menu wpmega postlist a color ffffff megaMenu megaMenuHorizontal ul megaMenu li menu item ss nav menu mega ul sub menu megaMenu megaMenuHorizontal ul megaMenu li menu item ss nav menu reg ul sub menu border top megaMenu ul megaMenu li menu item ss nav menu mega ul sub menu li menu item min width px megaMenu ul li menu item ss nav menu mega ul sub menu li menu item a megaMenu ul li menu item ss nav menu mega ul sub menu li menu item hover a megaMenu ul li menu item ss nav menu mega ul ul sub menu ss nav menu header a megaMenu ul li menu item ss nav menu mega ul sub menu li menu item span um anchoremulator megaMenu ul li menu item ss nav menu mega ul ul sub menu ss nav menu header span um anchoremulator megaMenu wpmega widgetarea h widgettitle color ffffff font size px font weight bold text shadow px px px transparent padding bottom em border bottom px dotted ffffff margin bottom em megaMenu ul li menu item ss nav menu mega ul sub menu li menu item hover a color ffffff megaMenu ul li menu item ss nav menu mega ul ul sub menu li menu item a megaMenu ul li menu item ss nav menu mega ul ul sub menu li menu item span um anchoremulator megaMenu ul ul sub menu li menu item a megaMenu ul ul sub menu li menu item span um anchoremulator color ffffff font size px text shadow px px px transparent background color bca megaMenu ul li menu item ss nav menu mega ul ul sub menu li menu item a hover megaMenu ul ul sub menu li menu item hover a color fff background color bca megaMenu ul megaMenu li menu item wpmega nonlink form searchform padding top px megaMenu ul megaMenu li menu item ss nav menu highlight a megaMenu ul megaMenu li menu item ss nav menu highlight span um anchoremulator color ffffff important megaMenu ss nav menu with img a wpmega link title megaMenu ss nav menu with img a wpmega link description megaMenu ss nav menu with img a wpmega item description megaMenu ss nav menu with img span um anchoremulator wpmega link title megaMenu ss nav menu with img span um anchoremulator wpmega link description megaMenu ss nav menu with img span um anchoremulator wpmega item description padding left px ss nav menu with img min height px megaMenu ul megaMenu li menu item a span wpmega item description megaMenu ul megaMenu li menu item span um anchoremulator span wpmega item description font size px line height em color bbbbbb text transform none megaMenu ul megaMenu li menu item mega with sub a after megaMenu ul megaMenu li menu item ss nav menu mega a after megaMenu ul megaMenu li menu item mega with sub span um anchoremulator after megaMenu ul megaMenu li menu item ss nav menu mega span um anchoremulator after border top color ffffff megaMenu ul megaMenu li menu item ss nav menu reg li menu item megaReg with sub a after megaMenu ul megaMenu li menu item ss nav menu reg li menu item megaReg with sub span um anchoremulator after border left color transparent megaMenu wpmega divider border top px solid ffffff border bottom px solid rgba megaMenu megaMenuVertical ul li menu item a megaMenu megaMenuVertical ul li menu item span um anchoremulator background color bca background webkit gradientlinear left top left bottom from bca to bca background webkit linear gradienttop bca bca background moz linear gradienttop bca bca background ms linear gradienttop bca bca background o linear gradienttop bca bca megaMenu megaMenuVertical ul li menu item ss nav menu reg li menu item megaReg with sub a after megaMenu megaMenuVertical ul li menu item mega with sub a after megaMenu megaMenuVertical ul li menu item ss nav menu mega a after megaMenu megaMenuVertical ul li menu item ss nav menu reg li menu item megaReg with sub span um anchoremulator after megaMenu megaMenuVertical ul li menu item mega with sub span um anchoremulator after megaMenu megaMenuVertical ul li menu item ss nav menu mega span um anchoremulator after border left color ffffff megaMenu megaMenuVertical ul megaMenu li menu item ss nav menu mega ul sub menu megaMenu megaMenuVertical ul megaMenu li menu item ss nav menu reg ul sub menu border left megaMenu megaMenuHorizontal ul megaMenu border bottom none megaMenu megaMenuVertical ul megaMenu border right none megaMenu ul megaMenu li menu item wpmega nonlink form searchform ubersearch v inputtype text color ffffff background megaMenu ul megaMenu li menu item wpmega nonlink form searchform ubersearch v inputtype submit color ffffff background megaMenu ul megaMenu li menu item wpmega nonlink form searchform ubersearch v inputtype submit hover color ffffff background Menu Width UberMenu Advanced Settings megaMenu width px max width Inner Menu Width used for centering UberMenu Advanced Settings megaMenu ul megaMenu max width px Image Text Padding megaMenu ss nav menu with img a wpmega link title megaMenu ss nav menu with img a wpmega link description megaMenu ss nav menu with img a wpmega item description megaMenu ss nav menu with img span um anchoremulator wpmega link title megaMenu ss nav menu with img span um anchoremulator wpmega link description megaMenu ss nav menu with img span um anchoremulator wpmega item description padding left px UberMenu Sticky CSS megaMenu margin important z index position fixed important top px bottom auto important webkit transition none moz transition none transition none Expand Menu Bar megaMenu left right auto width border radius Center Inner Menu megaMenu ubermenu sticky ul megaMenu padding left px margin auto float none max width px megaMenu megaMenuHorizontal ul megaMenu li first child a box shadow none Center Menubar megaMenu sticky wrapper margin auto max width width px Menu Bar Background megaMenu sticky wrapper megaMenu ubermenu sticky background Zebra Tooltip position absolute z index background transparent font family Geneva Lucida Sans Lucida Grande Lucida Sans Unicode Verdana sans serif Zebra Tooltip Zebra Tooltip Message position relative padding px font size inherit text align left font weight normal line height inherit webkit border radius px moz border radius px border radius px webkit box shadow px px px rgba moz box shadow px px px rgba box shadow px px px rgba margin right width expressiondocument body clientWidth px auto max width for IE Zebra Tooltip Zebra Tooltip Arrow position absolute height px width px overflow hidden Zebra Tooltip Zebra Tooltip Arrow Bottom bottom Zebra Tooltip Zebra Tooltip Arrow Top top Zebra Tooltip Zebra Tooltip Arrow div position absolute border style solid border width px height width left border left color pink border right color pink filter chromacolor pink Zebra Tooltip Zebra Tooltip Arrow Bottom div top border bottom color pink Zebra Tooltip Zebra Tooltip Arrow Top div bottom border top color pink Zebra Tooltip Zebra Tooltip Close text decoration none color FFF position absolute right px top px font size inherit font weight bold Zebra Tooltip Zebra Tooltip Close hover color C Menu nbsp Online Scanners Network Nmap Port Scanner Schedule Nmap Scans OpenVAS Scanner Web Nikto ScannerSSL checkSQL Injection ScanWhatWeb ScannerBlindElephant Scan CMS Apps WordPress ScannerJoomla Security ScanDrupal Security Scan Recon IP Information LookupFree IP Tools A range of open source scanning tools for all aspects of a security assessment Immediate access available Test today Tools Network Tests TracerouteTest Ping DNS Queries DNS lookupReverse DNSFind Host RecordsFind Shared DNS ServersZone TransferWhois Lookup IP Address GeoIP LookupReverse IP LookupPort CheckSubnet Lookup Web Tools HTTP HeadersPage Links Find IP and DNS information quickly with these FREE information gathering tools Easy access to these tools complements the in depth vulnerability scanners Research Blog Latest PostsTutorialsOpen Source ToolsResearch Most Popular Essential Open Source Security ToolsNessus OpenVAS and NexPose vs MetasploitableOffensive Security Tools for SysadminsRemote Access GrantedAttacking WordPressMapping WordPress attacks with Splunk Research and tutorials on all things open source security MEMBERSHIP LOG IN Quietly Mapping the Network Attack Surface When assessing the network security of an organization it is important to understand the breadth of the attack surface A single forgotten host or web application in the network will often become the initial foothold for an attacker Passively Mapping the Network Attack Surface
Using open source intelligence OSINT techniques and tools it is possible to map an organizations Internet facing networks and services without actually sending any packets or just a few standard requests to the target network Open source intelligence OSINT is defined as deriving intelligence from publicly available resources Looking at this another way an attacker can do a comprehensive analysis and mapping of your network infrastructure and technologies without actually sending you any packets and therefore without you having any knowledge that this reconnaissance has taken place Consider the following graphic you will notice that as the analysis is progressed newly discovered items IP address host names net blocks can open up new areas to explore and attack Identifying all known hosts for an organization allows us to continue to dig deeper for more systems and hosts to target By examining all discovered IP address blocks ASN we can find other hosts within the net block of interest Identifying related domains will lead to the discovery of more hosts Think of a single web server the actual open services ssh http rdp are all points of attack discovering all the virtual hosts running on the server is also important as web applications running on any of the virtual hosts are also an attack vector In this overview the focus is the gathering of information specifically related to the organizations network footprint and services Open source intelligence from social networks email addresses search engines and document meta data is often used for the purpose of developing a social engineering attack Basic DNS queries
Most domains will have a web site mail server and dns servers associated with it These will be our initial point of reference when discovering the attack surface We can use DNS lookup tools and whois to find where the web A records mail MX records and DNS NS records services are being hosted hackertarget com IN	A hackertarget com IN	AAAA	a e fc ff fe d hackertarget com IN	MX aspmx l google com hackertarget com IN	MX alt aspmx l google com hackertarget com IN	MX alt aspmx l google com hackertarget com IN	MX aspmx googlemail com hackertarget com IN	NS	ns domaincontrol com hackertarget com IN	NS	ns domaincontrol com Initial Host discovery Google Bing and Netcraft
A simple search for all host names related to the target domain is also a good starting point Using search engines such as Google site example com and Bing site example com can reveal sub domains and web hosts that may be of interest When searching with Google if there are a large number of results you can remove the known domains with the following query site example com site www example com
Google Hacking is a well documented technique that involves getting Google to reveal technical information that is of interest to an attacker The Google hacking database is the best place to get started if you are not familiar with this technique Another handy tool is the netcraft host search Enter the domain as your search term be sure to include the before your domain name to only get sub domains of your target domain You can see the Netcraft search provides a quick overview of known web hosts for the domain and the net blocks that they are hosted in Another interesting piece of information is the historical data Netcraft have been collecting this data for a long time Finding more hosts through data mining DNS records
Passive DNS reconnaissance allows discovery of DNS host records without actively querying the target DNS servers If DNS monitoring is in place active dns recon could be detected by the target Techniques that can be classed as active DNS recon include brute forcing common sub domains of the target or attempting DNS zone transfers query type AXFR There are many on line resources for passive DNS analysis and searching rather than sticking to regular DNS lookups we can perform large scale searches using DNS data sets One such resource is that provided by scans io the scans io data
Scans io and Project Sonar gather Internet wide scan data and make it available to researchers and the security community This data includes port scans and a dump of all the DNS records that they can find Using the DNS records dump you can search through over GB of DNS data for all entries that match your target domain If you do not wish to go through the trouble of downloading and extracting such a large chunk of data you can use our free tools to get started with your network reconnaissance Name Servers type NS
The location of the DNS servers may be internal to the organization network or as is often the case they be a hosted service This can be often be determined by simply looking up the net block owner ASN of the IP address of the DNS server When looking at DNS servers we can not only review the Host A records that point to the IP address of the DNS server but also do a reverse search across DNS data for all hosts that use the same DNS server In a hosted situation this may not be as valuable but if its an internal company DNS server we will quickly identify all related domains for the organization that are at least using this DNS infrastructure targetdomain com targetdomain co uk targetdomain net forgotten footy tipping site with no security controls com vpn targetdomain com webmail targetdomain com
SPF Records type TXT
Sender Policy Framework is configured through the TXT DNS record If configured this will contain all servers or networks that are allowed to send email from the domain This can often reveal IP addresses and net blocks of the organization that you may not have been aware of hackertarget com IN	TXT v spf include spf google com ip ip ip ip ip a e fc ff fe d ip c fc ff fee d include spf google com all Reverse DNS across IP blocks of Interest
Once you have a list of all IP addresses and ASN s of interest you can attempt to find more active hosts within those net blocks that the organizations owns or has assets within A good way of finding more hosts is to perform a reverse DNS search across the full net blocks of interest x host example com x targetdomain com x forgotten unpatched dev host targetdomain com x host example com
Finding Web Servers
When it comes to mapping a network the web servers of an organization open up a wide attack surface They also contain a wealth of information not just published but insights into the technologies in use operating systems and even how well managed the information technology resources of the organization are To map the attack surface of a web server it is important to consider the available network services the virtual hosts websites and the web applications in use Identifying all virtual web hosts on the web server is an important part of the information gathering process Different web sites on the same web server will often be managed using different content management systems and web applications A vulnerability in any of these web applications could allow code execution on the web server To identify the virtual web hosts on a particular IP Address there are a number of well known web based tools such as Bing and Robtex An IP address search using the ip search term on the Bing search engine will reveal all web sites that Bing has in its index that point to that same IP address Experience shows this is a good starting place but like the Bing search engine in general can contain stale entries and limited results As previously mentioned scans io regularly compiles all the DNS data it can publicly find we can use this data to identify the web server hosts A records By searching for an IP address in all the known DNS records we can find all the hosts that resolve to that IP This is the method we use for the Reverse IP Address Search tool we created and also parts of the dnsdumpster com project Other Network Services
In any vulnerability assessment it is essential to identify all listening services A web server will of course usually have a web server port an ftp server will have an FTP service port and a mail server will be listening for mail smtp on pop on imap on and more It is important to discover all the listening services in order to determine if they are vulnerable to exploitation or authentication attacks Traditionally these services would be identified using Port Scans with tools such as the Nmap Port Scanner Of course using a port scanner is no longer a passive undertaking as using a tool such as Nmap involves sending packets to the target systems shodan io search engine
To passively find open services and the banners for the open services we can use the shodan io search engine From the banners of services such as web servers mail and ftp we are able to identify the version of the server software running the service and often the operating system of the server All without sending any packets to the target organization dnsdumspter com is a Free tool that automagically collates DNS and host data Becoming the attacker and the Next Steps
Putting yourself in the shoes of an attacker and attempting to map out an organizations Internet facing systems is a great way to develop an understanding of the attack surface of a network Start by finding all the public IP addresses of known hosts for a domain expand this to include net blocks of interest that are hosting these services Now try to find all virtual host names that are hosted on the IP addresses and from this you can map out the web applications in use From this initial passive analysis it may be possible to identify vulnerable or possibly vulnerable points in the network this can inform your next steps and where to focus your attack or vulnerability assessment Moving on from passive analysis the next steps to consider are active information gathering such as DNS zone transfers or sub domain brute forcing Followed by active network scanning such as Nmap Port Scans and vulnerability scanning Ultimately the next steps will be determined by your scope and purpose for the performing the analysis Share this PostTry our Hosted Vulnerability Scanners Open Source Tools you can Trust day money back guarantee Get started in minutesstart here dns tools ip tools osint recon tshark tutorial and filter examples var disqus url https hackertarget com quietly mapping the network attack surface var disqus identifier http hackertarget com p var disqus container id disqus thread var disqus shortname hackertarget var disqus title Quietly Mapping the Network Attack Surface var disqus config custom window disqus config var disqus config function All currently supported events onReady fires when everything is ready onNewComment fires when a new comment is posted onIdentify fires when user is authenticated this language this callbacks onReady pushfunction sync comments in the background so we don t block the page var script document createElement script script async true script src cf action sync comments post id var firstScript document getElementsByTagName script firstScript parentNode insertBeforescript firstScript if disqus config custom disqus config custom callthis function var dsq document createElement script dsq type text javascript dsq async true dsq src disqus shortname disqus com embed js document getElementsByTagName head document getElementsByTagName body appendChilddsq HackerTarget com makes securing your systems easier with hosted open source vulnerability scanners Subscribe to the low volume list for updates Don t worry we hate vendor spam too copy Hacker Target Pty Ltd ACN Terms of Use Privacy Policy Powered by Open Source Software functioni s o g r a m i GoogleAnalyticsObject r ir ir function ir q ir q pusharguments ir l new Date a s createElemento m s getElementsByTagNameo a async a src g m parentNode insertBeforea m window document script www google analytics com analytics js ga ga create UA auto ga send pageview jQueryfunction new jQuery Zebra TooltipsjQuery tooltips background color color ffffff max width opacity position center jQuery function pleasewait hide clickform click function pleasewait show hideinput hide hideresult hide